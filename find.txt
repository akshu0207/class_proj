string ls_search, ls_search_column, ls_search_condition
long ll_row, ll_foundrow, ll_rv
integer li_col_count, i
string ls_col_name
any la_old_value, la_new_value
boolean lb_changes = FALSE

// Get search input and column name (Assuming you have a dropdown or user input for column selection)
ls_search = Trim(sle_search.Text)
ls_search_column = Trim(ddlb_search_column.Text)  // Dropdown for selecting column (id, first_name, etc.)

// Validate search column
IF ls_search_column = "" THEN
    MessageBox("Error", "Please select a column to search.")
    RETURN
END IF

// Build search condition dynamically
ls_search_condition = ls_search_column + " = '" + ls_search + "'"

// Get total number of rows in dw_master
ll_row = dw_master.RowCount()

// Find the existing row in dw_master
ll_foundrow = dw_master.Find(ls_search_condition, 1, ll_row)

IF ll_foundrow > 0 THEN
    // Scroll to found row and highlight it
    dw_master.ScrollToRow(ll_foundrow)
    dw_master.SetRowFocusIndicator(Hand!)

    // Get column count in dw_master
    li_col_count = dw_master.Describe("DataWindow.Column.Count")

    FOR i = 1 TO li_col_count
        ls_col_name = dw_master.Describe("#" + String(i) + ".Name")

        // Check if the column is modified
        IF dw_master.GetItemStatus(ll_foundrow, ls_col_name) = DataModified! THEN
            // Get old and new values
            la_old_value = dw_master.GetItem(ll_foundrow, ls_col_name)
            la_new_value = dw_master.GetItem(ll_foundrow, ls_col_name, Primary!)

            // Update only if value has changed
            IF NOT IsNull(la_new_value) AND la_old_value <> la_new_value THEN
                dw_master.SetItem(ll_foundrow, ls_col_name, la_new_value)
                lb_changes = TRUE
            END IF
        END IF
    NEXT

    // Only commit if changes exist
    IF lb_changes THEN
        dw_master.AcceptText()
        ll_rv = dw_master.Update(True, False)

        IF ll_rv = 1 THEN
            COMMIT USING SQLCA;
            MessageBox("Save Record", "Update Successful")
        ELSE
            ROLLBACK USING SQLCA;
            MessageBox("Save Record", "Update Failed")
        END IF
    ELSE
        MessageBox("No Changes", "No modifications detected.")
    END IF

ELSE
    MessageBox("Not Found", "No row found.")
END IF
