string ls_customers, ll_list, the_id, the_first_name, the_last_name, the_city, the_state
long ll_row, ll_foundrow, ll_find, ll_row_update, ll_cnt, ll_rv
 
ll_row = dw_master.RowCount()
 
ls_customers = Trim(sle_search.Text)
 
ll_foundrow = dw_master.Find( &
      "first_name = '" + ls_customers + "'", 1, ll_row)
IF ll_foundrow > 0 THEN
      dw_master.ScrollToRow(ll_foundrow)
	  dw_master.SetRowFocusIndicator(Hand!)
	  dw_detail.setitem(1,"id",dw_master.GetItemNumber(ll_foundrow,"id"))
	  dw_detail.setitem(1,"first_name",dw_master.GetItemstring(ll_foundrow,"first_name"))
	  dw_detail.setitem(1,"last_name",dw_master.GetItemstring(ll_foundrow,"last_name"))
	  dw_detail.setitem(1,"city",dw_master.GetItemstring(ll_foundrow,"city"))
	  dw_detail.setitem(1,"state",dw_master.GetItemstring(ll_foundrow,"state"))
ELSE
      MessageBox("Not Found", "No row found.")
	  ll_row = dw_master.insertrow(0)
	  if ll_row_update > 0 then
		ll_cnt = 0
		do
			ll_cnt++
	  ll_find= dw_master.find("id = "+string(the_id)+" and first_name = "+string(the_first_name)+" and last_name = "+string(the_last_name)+" and city = "+string(the_city)+ " and state =  '"+ls_customers+"'",1,dw_master.rowcount())
	  dw_master.setitem(ll_row,"id",dw_detail.getitemstring(ll_cnt,"id"))
	  dw_master.setitem(ll_row,"first_name",dw_detail.getitemstring(ll_cnt,"first_name"))
	  dw_master.setitem(ll_row,"last_name",dw_detail.getitemstring(ll_cnt,"last_name"))
	  dw_master.setitem(ll_row,"city",dw_detail.getitemstring(ll_cnt,"city"))
	  dw_master.setitem(ll_row,"state",dw_detail.getitemstring(ll_cnt,"state"))
	  loop until ll_cnt >= dw_detail.rowcount( )
			
		dw_master.accepttext( )
		ll_rv = dw_master.update(true,false)
			
		if ll_rv = 1 then
			commit using sqlca;
			Messagebox("Save Record","Update Success")
		else
			ROLLBACK using sqlca;
			Messagebox("Save Record","Update Failure")
		end if
END IF
end if
