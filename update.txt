IF dw_detail.AcceptText() <> 1 OR dw_master.AcceptText() <> 1 THEN
    MessageBox("Error", "Failed to accept text input.")
    RETURN
END IF

// Only update if changes exist
IF dw_detail.ModifiedCount() > 0 THEN
    IF dw_detail.Update() = 1 THEN
        IF dw_master.Update() = 1 THEN
            COMMIT USING SQLCA;
            MessageBox("Save", "Save succeeded")
            this.event ue_retrieve() // Refresh data
        ELSE
            ROLLBACK USING SQLCA;
            MessageBox("Error", "Update failed in dw_master. SQLCode: " + String(SQLCA.SQLCode))
        END IF
    ELSE
        ROLLBACK USING SQLCA;
        MessageBox("Error", "Update failed in dw_detail. SQLCode: " + String(SQLCA.SQLCode))
    END IF
ELSE
    MessageBox("No Changes", "No modifications were detected.")
END IF
