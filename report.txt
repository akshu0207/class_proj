// Example: Clicked event of btn_report
string ERRORS, sql_syntax, presentation_str, dwsyntax_str
string selected_cols, layout_style, where_clause

// üß† 1. Get user inputs
selected_cols = sle_cols.Text
layout_style  = ddlb_layout.Text
where_clause  = sle_filter.Text

// Validate inputs
IF selected_cols = "" THEN
   MessageBox("Error", "Please enter column names.")
   RETURN
END IF

IF layout_style = "" THEN
   layout_style = "grid"  // default
END IF

// üõ†Ô∏è 2. Build dynamic SQL
sql_syntax = "SELECT " + selected_cols + " FROM customers"

IF Trim(where_clause) <> "" THEN
   sql_syntax += " WHERE " + where_clause
END IF

sql_syntax += " ORDER BY id"

// üß± 3. Build presentation string
presentation_str = "style(type=" + layout_style + ")"

// üèóÔ∏è 4. Generate dynamic DataWindow syntax
dwsyntax_str = SQLCA.SyntaxFromSQL(sql_syntax, presentation_str, ERRORS)

IF Len(ERRORS) > 0 THEN
   MessageBox("Caution", "SyntaxFromSQL Error: " + ERRORS)
   RETURN
END IF

// üîÑ 5. Create DataWindow and retrieve data
dw_master.Reset()
dw_master.Create(dwsyntax_str, ERRORS)
dw_master.AcceptText()

IF Len(ERRORS) > 0 THEN
   MessageBox("Caution", "Create Error: " + ERRORS)
   RETURN
END IF

dw_master.SetTransObject(SQLCA)
dw_master.Retrieve()
SQLCA.AutoCommit = FALSE
